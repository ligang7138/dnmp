#https://blog.csdn.net/skh2015java/article/details/80410348
version: '2.2'
services:
  nginx:
    image: nginx:latest
    ports:
      - "80:80"
        #- "443:443"
    links:
      - php:fpm
    volumes_from:
      - www
  php:
    image: ligang7138/php7.3-fpm-alpine1
    #image: ligang7138/php7.2-fpm
    #image: php:7.2-rc-fpm-alpine3.6
    #build: ./php/php72/
    ports:
      - "9000:9000"      
    expose:
      - "9000"
    volumes_from:
      - php-config  
        #links:
      #- mysql:mysql
      # - redis:redis
      #  mysql:
      #image: mariadb:latest
      #ports:
      #- "127.0.0.1:3306:3306"
      # volumes:
      #- ./conf/mysql/my.cnf:/etc/mysql/my.cnf:rw
      #- ./mysql/:/var/lib/mysql/:rw
      #- ./log/mysql/:/var/log/mysql/:rw
      #environment:
      #MYSQL_ROOT_PASSWORD: "123456"
      #redis:
          #image: redis:latest
          #ports:
          #- "6379:6379"
  www:
    image: busybox
    volumes:
      - ./conf/nginx/conf.d:/etc/nginx/conf.d/:rw
        #- ./conf/nginx/nginx.conf:/etc/nginx/nginx.conf:rw
        #- ./conf/nginx/mime.types:/etc/nginx/mime.types:rw
      - ./log/nginx/:/var/log/nginx/:rw
    command: /bin/sh -c "while true; do echo 1 > /dev/null; sleep 1000; done;"
  php-config:
    image: busybox 
    volumes:
      - ./www/:/var/www/html/:rw
        # - ./conf/php/php.ini:/usr/local/etc/php/php.ini:rw
        # - ./conf/php/php-fpm.d/www.conf:/etc/php/7.0/fpm/conf.d/www.conf:rw
      - ./log/php-fpm/:/var/log/php-fpm/:rw
    command: /bin/sh -c "while true; do echo 1 > /dev/null; sleep 1000; done;" 
